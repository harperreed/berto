var _0x3678=['\x20-\x20','[berto]\x20Invalid\x20Topic','minimist','error','[berto]\x20Loading\x20Modules','node-getmac','slice','berto-hub','[berto]\x20Reading\x20In\x20Configuration','url','mqtt','username','password','flic','servers','homekit','connect','[berto]\x20Unable\x20To\x20Connect\x20To\x20','exit','subscribe','topic','/+/server/#','match','publish','[berto]\x20Subscribed\x20To\x20','client','init','parse','[berto]\x20Executing\x20','[berto]\x20Command\x20','\x20Does\x20Not\x20Exist'];(function(_0x6c25f3,_0x5b3d27){var _0x2f13f1=function(_0x1b8651){while(--_0x1b8651){_0x6c25f3['push'](_0x6c25f3['shift']());}};var _0x4d9e09=function(){var _0x3a3757={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x51a779,_0x3d26aa,_0xd50695,_0x1dda10){_0x1dda10=_0x1dda10||{};var _0x13e6bf=_0x3d26aa+'='+_0xd50695;var _0x118e8f=0x0;for(var _0x118e8f=0x0,_0x9eba00=_0x51a779['length'];_0x118e8f<_0x9eba00;_0x118e8f++){var _0x19ace1=_0x51a779[_0x118e8f];_0x13e6bf+=';\x20'+_0x19ace1;var _0x12428a=_0x51a779[_0x19ace1];_0x51a779['push'](_0x12428a);_0x9eba00=_0x51a779['length'];if(_0x12428a!==!![]){_0x13e6bf+='='+_0x12428a;}}_0x1dda10['cookie']=_0x13e6bf;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5651d3,_0x492e9e){_0x5651d3=_0x5651d3||function(_0x3c8118){return _0x3c8118;};var _0x2e564a=_0x5651d3(new RegExp('(?:^|;\x20)'+_0x492e9e['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0xb67e4b=function(_0x346e23,_0xeff612){_0x346e23(++_0xeff612);};_0xb67e4b(_0x2f13f1,_0x5b3d27);return _0x2e564a?decodeURIComponent(_0x2e564a[0x1]):undefined;}};var _0x4410bc=function(){var _0x487daa=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x487daa['test'](_0x3a3757['removeCookie']['toString']());};_0x3a3757['updateCookie']=_0x4410bc;var _0x59af00='';var _0x2d6a80=_0x3a3757['updateCookie']();if(!_0x2d6a80){_0x3a3757['setCookie'](['*'],'counter',0x1);}else if(_0x2d6a80){_0x59af00=_0x3a3757['getCookie'](null,'counter');}else{_0x3a3757['removeCookie']();}};_0x4d9e09();}(_0x3678,0xdb));var _0x1d88=function(_0x3560e4,_0x291297){_0x3560e4=_0x3560e4-0x0;var _0x1aaaad=_0x3678[_0x3560e4];return _0x1aaaad;};var _0x5f22e9=function(){var _0x52403c=!![];return function(_0x2cfb82,_0x13277a){var _0x5c1f9a=_0x52403c?function(){if(_0x13277a){var _0x2b7175=_0x13277a['apply'](_0x2cfb82,arguments);_0x13277a=null;return _0x2b7175;}}:function(){};_0x52403c=![];return _0x5c1f9a;};}();var _0x43b549=_0x5f22e9(this,function(){var _0x44a26b=function(){return'\x64\x65\x76';},_0x41a46e=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0xb57044=function(){var _0x49cb5d=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x49cb5d['\x74\x65\x73\x74'](_0x44a26b['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x23278c=function(){var _0x1b6012=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x1b6012['\x74\x65\x73\x74'](_0x41a46e['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x903f86=function(_0x246d4e){var _0x5365b6=~-0x1>>0x1+0xff%0x0;if(_0x246d4e['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5365b6)){_0x1c494d(_0x246d4e);}};var _0x1c494d=function(_0x4728f4){var _0x9fa2d6=~-0x4>>0x1+0xff%0x0;if(_0x4728f4['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x9fa2d6){_0x903f86(_0x4728f4);}};if(!_0xb57044()){if(!_0x23278c()){_0x903f86('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x903f86('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x903f86('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x43b549();const COMMON=require('./common');const minimist=COMMON[_0x1d88('0x0')];const print=COMMON['print'];const error=COMMON[_0x1d88('0x1')];print(_0x1d88('0x2'));const MQTT=require('mqtt');const MAC=require(_0x1d88('0x3'));const args=minimist(process['argv'][_0x1d88('0x4')](0x2));const DEBUG=args['d'];ENV={'topic':_0x1d88('0x5'),'uuid':MAC,'mqtt':{'url':'mqtt://localhost:1883'},'servers':{'berto':{}}};print(_0x1d88('0x6'));if(args[_0x1d88('0x7')]){ENV[_0x1d88('0x8')][_0x1d88('0x7')]=args[_0x1d88('0x7')];}if(args['u']){ENV[_0x1d88('0x8')][_0x1d88('0x9')]=args['u'];}if(args['P']){ENV['mqtt'][_0x1d88('0xa')]=args['P'];}if(args[_0x1d88('0xb')]){ENV[_0x1d88('0xc')]['flic']={};}if(args[_0x1d88('0xd')]){ENV[_0x1d88('0xc')][_0x1d88('0xd')]={'storage':args[_0x1d88('0xd')]};}print('[berto]\x20Attempting\x20Connection\x20To\x20'+ENV[_0x1d88('0x8')][_0x1d88('0x7')]);var mqtt_client=MQTT[_0x1d88('0xe')](ENV['mqtt'][_0x1d88('0x7')],{'username':ENV[_0x1d88('0x8')][_0x1d88('0x9')],'password':ENV['mqtt'][_0x1d88('0xa')]});mqtt_client['on'](_0x1d88('0x1'),function(_0x27e94f){error(_0x1d88('0xf')+ENV[_0x1d88('0x8')][_0x1d88('0x7')]);process[_0x1d88('0x10')](0x1);});mqtt_client['on']('connect',function(_0xd95062){print('[berto]\x20Connected\x20To\x20MQTT\x20Broker');ENV[_0x1d88('0x8')][_0x1d88('0x11')]=ENV[_0x1d88('0x12')]+_0x1d88('0x13');ENV[_0x1d88('0x8')][_0x1d88('0x14')]=ENV[_0x1d88('0x12')]+'/(.+)/server/(.+)';ENV['mqtt'][_0x1d88('0x15')]=ENV[_0x1d88('0x12')]+'/';mqtt_client['subscribe'](ENV[_0x1d88('0x8')][_0x1d88('0x11')],function(_0xa45d92){if(_0xa45d92){error(_0xa45d92);process[_0x1d88('0x10')](0x1);}print(_0x1d88('0x16')+ENV['mqtt']['subscribe']);for(var _0x42f8e8 in ENV[_0x1d88('0xc')]){try{ENV[_0x1d88('0xc')][_0x42f8e8]=require('./'+_0x42f8e8);ENV[_0x1d88('0xc')][_0x42f8e8][_0x1d88('0x17')]=ENV[_0x1d88('0xc')][_0x42f8e8][_0x1d88('0x18')](mqtt_client);}catch(_0x5dc0b1){error(_0x5dc0b1);delete ENV[_0x1d88('0xc')][_0x42f8e8];}}mqtt_client['on']('message',function(_0x258ac5,_0x19a890){print('[berto]\x20Message\x20Received\x20On\x20Topic\x20'+_0x258ac5);var _0x3cbf6b=_0x258ac5[_0x1d88('0x14')](ENV[_0x1d88('0x8')][_0x1d88('0x14')]);if(_0x3cbf6b&&ENV[_0x1d88('0xc')][_0x3cbf6b[0x1]]){var _0x6a311b=_0x3cbf6b[0x2];if(_0x6a311b){var _0x42f8e8=ENV[_0x1d88('0xc')][_0x3cbf6b[0x1]];var _0x51906b=_0x42f8e8['commands'];try{var _0x41edb6=JSON[_0x1d88('0x19')](_0x19a890);var _0x2ad495='server_'+_0x6a311b;if(_0x51906b[_0x2ad495]){print(_0x1d88('0x1a')+_0x6a311b);_0x51906b[_0x2ad495](mqtt_client,_0x42f8e8['client'],_0x41edb6);}else{error(_0x1d88('0x1b')+_0x6a311b+_0x1d88('0x1c'));}}catch(_0x132e20){error('[berto]\x20'+_0x132e20+_0x1d88('0x1d')+_0x19a890);}}else{print('[berto]\x20Command\x20Not\x20Specified\x20In\x20'+_0x258ac5+'\x20Topic');}}else{error(_0x1d88('0x1e'));}});});});